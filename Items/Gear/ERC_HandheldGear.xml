<?xml version="1.0" encoding="utf-8"?>
<Items>
  <!-- =================================================================
       ERC HANDHELD GEAR (个人装备)
       包含: 精兵弹药单元, 精兵收纳单元
       ================================================================= -->

  <!-- 1. ERC_elite_ammounit (精兵弹药单元) -->
  <Item identifier="ERC_elite_ammounit" category="Equipment" tags="smallitem,mobilecontainer" scale="0.5" fireproof="true" waterproof="true">
    <Price baseprice="150" />
    <Sprite texture="%ModDir%/Images/Containers/ERC_EliteAmmoUnit.png" depth="0.6" sourcerect="0,0,150,90" origin="0.5,0.5" />
    <Body width="80" height="50" density="10" />
    
    <Holdable slots="Any,RightHand,LeftHand" holdpos="0,-20" msg="ItemMsgPickUpSelect" />
    
    <!-- 特性: 适配EA弹药，且使用 SubContainer 实现堆叠数+2 -->
    <ItemContainer capacity="9" slotsperrow="3" canbeselected="true" hideitems="true" msg="ItemMsgInteractSelect" drawinventory="true">
      <GuiFrame relativesize="0.15,0.25" anchor="Center" style="ItemUI" />
      
      <SubContainer capacity="9" slotsperrow="3" ExtraStackSize="2">
        <Containable identifiers="ammobox,coilgunammo,railgunammo,depthchargeammo,explosive,grenade,harpoonammo,revolverammo,pistolammoitem,smgammo,demolitionsexpert,mobilebattery,shotgunammo,stungunammo,reactorfuel,assaultrifleammo,nitroglycerin,ehaammo,rifleammo,magazine" />
      </SubContainer>
    </ItemContainer>
  </Item>


  <!-- 2. ERC_elite_storageunit (精兵收纳单元) -->
  <Item identifier="ERC_elite_storageunit" category="Equipment" tags="smallitem,mobilecontainer" scale="0.5">
    <Price baseprice="120" />
    <Sprite texture="%ModDir%/Images/Containers/ERC_EliteStorageUnit.png" depth="0.6" sourcerect="0,0,150,90" origin="0.5,0.5" />
    <Body width="80" height="50" density="10" />
    
    <Holdable slots="Any,RightHand,LeftHand" holdpos="0,-20" msg="ItemMsgPickUpSelect" />
    
    <ItemContainer capacity="16" slotsperrow="4" canbeselected="true" hideitems="true" msg="ItemMsgInteractSelect">
      <Containable items="smallitem,mediumitem" />
      <GuiFrame relativesize="0.2,0.3" anchor="Center" style="ItemUI" />
    </ItemContainer>
  </Item>

  <!-- 3. ERC_elite_medicalunit (战地医疗单元) -->
  <Item identifier="ERC_elite_medicalunit" category="Equipment" tags="smallitem,mobilecontainer,medicalcontainer" scale="0.5" fireproof="true" waterproof="true">
    <Price baseprice="200" />
    <Sprite texture="%ModDir%/Images/Containers/ERC_EliteMedicalUnit.png" depth="0.6" sourcerect="0,0,150,90" origin="0.5,0.5" />
    <Body width="80" height="50" density="10" />
    
    <Holdable selectkey="Select" pickkey="Use" slots="Any,RightHand,LeftHand" msg="ItemMsgDetachWrench" PickingTime="2.0" aimpos="60,0" holdpos="0,-20" attachable="true" aimable="false">
    </Holdable>
    
    <ItemContainer capacity="16" slotsperrow="4" canbeselected="true" hideitems="true" msg="ItemMsgInteractSelect" drawinventory="true">
      <GuiFrame relativesize="0.2,0.3" anchor="Center" style="ItemUI" />
      <Containable tags="medical,chem,poison,geneticmaterial,syringe,bandage,bloodpack,alienblood,antidote,stimulant" />
    </ItemContainer>
  </Item>


  <!-- 4. organtoolbox (小型器官冷藏箱 - 覆写) -->
  <!-- 使用 Override 标签覆盖原版或其他Mod的同名物品 -->
  <Override>
    <Item identifier="organtoolbox" category="Equipment" tags="mediumitem,mobilecontainer,tool,refrigerated,toolbox" cargocontaineridentifier="" showcontentsintooltip="true" Scale="0.5" fireproof="true" impactsoundtag="impact_metal_heavy" RequireAimToUse="True">
      
      <!-- 容器生成概率与价格 (保留您提供的代码逻辑) -->
      <PreferredContainer primary="medcab" minamount="1" maxamount="1" />
      <PreferredContainer secondary="wreckstoragecab" spawnprobability="0.05" />
      <PreferredContainer secondary="locker" />
      
      <Price baseprice="125"> <!-- 稍微提高价格 -->
        <Price storeidentifier="merchantmedical" sold="true" multiplier="0.9" minavailable="8" />
        <Price locationtype="outpost" multiplier="1" minavailable="4" />
        <Price locationtype="city" multiplier="0.9" minavailable="6" />
        <Price locationtype="research" multiplier="1.25" minavailable="1" />
        <Price locationtype="military" multiplier="1.25" minavailable="1" />
        <Price locationtype="mine" multiplier="1.25" minavailable="8" />
      </Price>

      <Deconstruct time="10">
        <Item identifier="steel" />
        <Item identifier="potassium" amount="2" />
      </Deconstruct>
      
      <Fabricate suitablefabricators="fabricator" requiredtime="20">
        <RequiredSkill identifier="mechanical" level="20" />
        <Item identifier="steel" />
        <Item identifier="potassium" amount="2" />
        <Item identifier="phosphorus" />
      </Fabricate>

      <!-- 
        使用占位贴图: ERC_OrganToolbox.png
        注意: sourcerect 设为 0,0,150,90 以匹配您的占位图规范
      -->
      <Sprite texture="%ModDir%/Images/Containers/InGameItemIconAtlas.png" sourcerect="173,403,84,67" origin="0.5,0.5" depth="0.6" />
      
      <Body width="90" height="60" density="20" />
      
      <!-- 攻击逻辑 -->
      <MeleeWeapon slots="RightHand,LeftHand" controlpose="true" aimpos="45,10" handle1="0,18" holdangle="90" reload="1" range="50" combatpriority="6" msg="ItemMsgPickUpSelect">
        <Attack structuredamage="0" itemdamage="1" targetimpulse="2">
          <Affliction identifier="blunttrauma" strength="2" />
          <Affliction identifier="stun" strength="0.6" />
          <StatusEffect type="OnUse" target="UseTarget">
            <Conditional entitytype="eq Character" />
            <Sound file="Content/Items/Weapons/Smack1.ogg" selectionmode="random" range="500" />
            <Sound file="Content/Items/Weapons/Smack2.ogg" range="500" />
          </StatusEffect>
        </Attack>
      </MeleeWeapon>
      
      <!-- 
        核心修改: 扩容到 9 格 (3x3)
      -->
      <ItemContainer capacity="9" slotsperrow="3" keepopenwhenequipped="true" movableframe="true">
        <Containable items="smallitem,organ" excludeditems="toolbelt,toolbox" />
        <GuiFrame relativesize="0.15,0.25" anchor="Center" style="ItemUI" />
      </ItemContainer>
      
      <aitarget sightrange="1000" soundrange="1000" fadeouttime="2" />
    </Item>
  </Override>
</Items>